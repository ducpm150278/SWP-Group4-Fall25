else if (section != null && section.equals("screening-room-management")) {
nbproject/build-impl.xml.data.CRC32=76540ef8
nbproject/build-impl.xml.script.CRC32=b833dde2
nbproject/build-impl.xml.stylesheet.CRC32=334708a0@1.93.0.1
    ScreeningRoomDAO roomDAO = new ScreeningRoomDAO();
    CinemaDAO cinemaDAO = new CinemaDAO();
    SeatDAO seatDAO = new SeatDAO();

    try {
        String action = request.getParameter("action");

        // Xử lý generate seats
        if ("generateSeats".equals(action)) {
            try {
                int roomId = Integer.parseInt(request.getParameter("roomId"));
                
                ScreeningRoom room = roomDAO.getRoomById(roomId);
                if (room == null) {
                    request.getSession().setAttribute("showToast", "generate_error");
                    request.getSession().setAttribute("showError", "Room not found");
                    response.sendRedirect("dashboard?section=screening-room-management&action=edit&id=" + roomId);
                    return;
                }
                
                // Tạo seats mặc định
                SeatLayout layout = new SeatLayout();
                List<Seat> seats = layout.generateSeats(roomId, room.getRoomType());
                
                // Xóa seats cũ (nếu có)
                seatDAO.deleteSeatsByRoom(roomId);
                
                // Lưu seats mới
                boolean seatsCreated = seatDAO.createBulkSeats(seats);
                
                if (seatsCreated) {
                    // Cập nhật seat capacity
                    room.setSeatCapacity(seats.size());
                    roomDAO.updateRoom(room);
                    
                    request.getSession().setAttribute("showToast", "generate_success");
                    request.getSession().setAttribute("showMessage", "Generated " + seats.size() + " seats successfully");
                } else {
                    request.getSession().setAttribute("showToast", "generate_error");
                    request.getSession().setAttribute("showError", "Failed to generate seats");
                }
                
                response.sendRedirect("dashboard?section=screening-room-management&action=edit&id=" + roomId);
                return;
                
            } catch (NumberFormatException e) {
                request.getSession().setAttribute("showToast", "generate_error");
                request.getSession().setAttribute("showError", "Invalid room ID");
                response.sendRedirect("dashboard?section=screening-room-management");
                return;
            }
        }

        // Xử lý edit seat (hiển thị form chỉnh sửa seat)
        if ("editSeat".equals(action)) {
            try {
                int seatId = Integer.parseInt(request.getParameter("seatId"));
                int roomId = Integer.parseInt(request.getParameter("roomId"));
                
                Seat seat = seatDAO.getSeatById(seatId);
                ScreeningRoom room = roomDAO.getRoomById(roomId);
                
                if (seat != null && room != null) {
                    request.setAttribute("editSeat", seat);
                    request.setAttribute("viewRoom", room);
                    
                    // Lấy danh sách seats để hiển thị layout
                    List<Seat> seats = seatDAO.getSeatsByRoom(roomId);
                    request.setAttribute("seats", seats);
                } else {
                    request.getSession().setAttribute("showToast", "error");
                    request.getSession().setAttribute("showError", "Seat or room not found");
                }
                
                request.setAttribute("section", section);
                
            } catch (NumberFormatException e) {
                request.getSession().setAttribute("showToast", "error");
                request.getSession().setAttribute("showError", "Invalid seat or room ID");
            }
        }

        if (action != null && (action.equals("view") || action.equals("edit") || action.equals("create"))) {
            if (action.equals("view") || action.equals("edit")) {
                int roomId = Integer.parseInt(request.getParameter("id"));
                ScreeningRoom room = roomDAO.getRoomById(roomId);
                if (room != null) {
                    System.out.println("Room found: " + room.getRoomName());
                    request.setAttribute("viewRoom", room);

                    // Lấy danh sách ghế
                    List<Seat> seats = seatDAO.getSeatsByRoom(roomId);
                    request.setAttribute("seats", seats);
                    System.out.println("Seats loaded: " + (seats != null ? seats.size() : 0));
                }
            } else if (action.equals("create")) {
                // Xử lý cho create action
                String cinemaIdParam = request.getParameter("cinemaId");
                if (cinemaIdParam != null) {
                    try {
                        int cinemaId = Integer.parseInt(cinemaIdParam);
                        Cinema cinema = cinemaDAO.getCinemaById(cinemaId);
                        request.setAttribute("cinema", cinema);
                    } catch (NumberFormatException e) {
                        System.out.println("Invalid cinema ID: " + cinemaIdParam);
                    }
                }
            }
            request.setAttribute("section", section);
        } else {
            // Phần code filter hiện tại của bạn...
        }

    } catch (NumberFormatException e) {
        System.out.println("Error in room-management doGet: " + e.getMessage());
    }
}
